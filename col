#!/bin/bash
i="${1:-/dev/stdin}" 
sed -r '/^##/ s/\t/%t%/g;
  :x; s/(^|\t)\t/\1NA\t/; tx
  /^##/! s/^/]\t/
  0,/^]/ {
    /^##/! s/$/\t/
    :a
    /[^]]\t/{
      x;:b;s/9(_*)$/_\1/;tb;s/^(_*)$/0\1/;s/$/:0123456789/;s/([^_])(_*):.*\1(.).*/\3\2/;s/_/0/g;x;G;
      s/([^]\t]+)\t(.*)\n(.*)/\1[\3]\t\2/;
      ta
    }
  }
  100000q
  ' < $i |
column -t -s $'\t' | sed 's/^][ ]*//;s/%t%/\t/g'|less -FS~ 
